{% extends "layout.html" %}

{% block content %}

<div class="container">
<h3 class=" text-center">Messaging</h3>
<div class="messaging">
      <div class="inbox_msg">
        <div class="inbox_people">
          <div class="headind_srch">
            <div class="recent_heading">
              <h4>Recent</h4>
            </div>
            <div class="srch_bar">
              <div class="stylish-input-group">
                <input type="text" class="search-bar"  placeholder="Search" >
                <span class="input-group-addon">
                <button type="button"> <i class="fa fa-search" aria-hidden="true"></i> </button>
                </span> </div>
            </div>
          </div>
          <div class="inbox_chat">

          {% for i in side_bar %}
          {% for k,v in i.items() %} 

            <div class="chat_list">
              <div class="chat_people">
                <div class="chat_img rounded-circle"> <img src="{{ v['senderProfileURI'] }}" alt="profile_image"> </div>
                <div class="chat_ib">
                  <h5>{{ v['senderName'] }} <span class="chat_date">{{ v['msgTime']|time }}</span></h5>
                  <p>{{ v['msg'] }}.</p>
                </div>
              </div>
            </div>
            
            {% endfor %}
            {% endfor %}

          </div>
        </div>
        <div class="mesgs">
          <div class="msg_history">

            {% for k,v in first_person_data.items() %}

            {% if v['senderId'] != "17352015" %}
            <div class="incoming_msg">
              <div class="incoming_msg_img"> <img src="{{ v['senderProfileURI'] }}" alt="sunil"> </div>
              <div class="received_msg">
                <div class="received_withd_msg">
                  <p>{{ v['msg'] }}</p>
                  <span class="time_date"> {{ v['msgTime']|time  }} </span></div>
              </div>
            </div>
            {% else %}
            <div class="outgoing_msg">
              <div class="sent_msg">
                <p>Test which is a new approach to have all
                  solutions</p>
                <span class="time_date"> 11:01 AM    |    June 9</span> </div>
            </div>
            {% endif %}
            {% endfor %}
            
          </div>
          <div class="type_msg">
            <div class="input_msg_write">
              <input type="text" class="write_msg" placeholder="Type a message" />
              <button id="send_btn" class="msg_send_btn" type="button" value="{{senderID}}" ><i class="fa fa-paper-plane-o" aria-hidden="true"></i></button>
            </div>
          </div>
        </div>
      </div>
      
      
      <p class="text-center top_spac"> Design by <a target="_blank" href="#">Sunil Rajput</a></p>
      
    </div></div>


    <script type="text/javascript">
      $(document).ready(function() {
      
      $( "#send_btn" ).click(function() {
        var msg = $(".write_msg").val();
        var senderID = $(this).val();
        console.log("this is message : " + msg)
          $.ajax({
                  url: '/send_message',
                  datatype : 'application/json;charset=UTF-8',
                  data: {"data": "admin", "msg" : msg, "senderid" : senderID  },
                  type: 'POST',
                  success: function(response){
                          console.log(response);
                      
                },
                error: function(error){
                  console.log(error);
                }
              });
      });
      
      });
      </script>




{% endblock %}